<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../node_modules/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../../assets/css/variables.css" />
    <link rel="stylesheet" href="../../assets/css/global.css" />
    <link rel="stylesheet" href="../../assets/css/setup.css" />
  </head>
  <body style="-webkit-app-region: drag;">
    <div class="container text-center">
      <div class="row h-100">
        <div class="col-8 m-auto">
          <section id="content">
            <h2>
              Let's stay in touch.
            </h2>
            <h4 class="mt-5">
              Enter the email address associated with your account to receive updates related to your account and your
              goal.
            </h4>
            <h5 class="mt-5">
              Your email
            </h5>
            <input class="mt-2" type="text" id="email" />
            <div>
              <button class="btn mt-5" id="continue">
                Continue
              </button>
            </div>
          </section>
          <section id="loading" hidden>
            <img width="35px" src="https://thumbs.gfycat.com/CorruptOldfashionedGuineapig-small.gif" />
          </section>
        </div>
      </div>
    </div>

    <script>
      require("bootstrap");
      const path = require("path");
      const { defaultStore } = require("../../common/store");
      const { updateSettings } = require("../../common/users");

      window.onload = function () {
        defaultStore.get("deskSettings").userEmail &&
          (document.getElementById("email").value = defaultStore.get("deskSettings").userEmail);
        document.getElementById("email").focus();
      };

      document.getElementById("continue").addEventListener("click", function () {
        document.getElementById("content").hidden = true;
        document.getElementById("loading").hidden = false;
        updateSettings("userEmail", document.getElementById("email").value).then(() => {
          window.location = path.join("file://", __dirname, "../../render-process/setup/summary.html");
        });
      });
    </script>
  </body>
</html>
